# å°é¦¨å®æ ‘æ´å‰ç«¯å¼€å‘æŒ‡å¯¼

## ğŸ§‘â€ğŸ’» User


è¯·å¸®æˆ‘é’ˆå¯¹å¿ƒç†æ ‘æ´è¾“å‡ºä¸€ä¸ªæŒ‡ä»¤å³å¯ï¼Œæˆ‘æœ‰åå°çš„api-urlï¼Œä½ å¸®æˆ‘å†™ä¸ªå‰ç«¯å¼€å‘æŒ‡å¯¼æ–‡æ¡£å³å¯ï¼Œæ ‘æ´åç§°å«åšå°é¦¨å®ï¼Œé“¾æ¥http://xiaoxinbao.org/

---
## ğŸ¤– Gemini 3 Pro Preview

<div style="border: 2px solid #dddddd; border-radius: 10px;">
  <details style="padding: 5px;">
    <summary>å·²æ·±åº¦æ€è€ƒ</summary>
    **Analyzing the Goal**<br><br>I've been drilling into the initial request to fully grasp the objective. I'm focusing on dissecting the specifics and nuances. My current efforts are concentrating on identifying the core deliverables and the intended scope of the frontend documentation. This exploration is forming the groundwork for the next phases.<br><br><br>**Framing the Spec**<br><br>The focus is now on structuring the frontend spec. I'm prioritizing clarity for the developer. I've broken down the "Tree Hole" functionality, aiming for a precise technical guide.  Understanding the target audience is key. I'm striving to create a single, actionable document.<br><br><br>**Outlining Key Features**<br><br>I'm now identifying the core features needed for the AI chat interface. We need a chat UI, input area, history, and a privacy disclaimer, aiming for a calming and supportive feel in the design. I've also listed the core functionality, as well as a list of potential features. Next up is deciding on the tech stack.<br><br><br>**Constructing the Architecture**<br><br>I'm solidifying the technical architecture now. The project is Xiaoxinbao Tree Hole, frontend-only with backend API integration. Healing UI is the key UX principle. I'm nailing down the "God Prompt", acting as the Senior Frontend Engineer. I'm focusing on Next.js, TypeScript, Tailwind, Lucide Icons, and Axios. The mobile-first design and streaming response handling are crucial, with a mandatory Medical Disclaimer.<br><br><br>**Crafting the Documentation**<br><br>I'm now in the process of generating the final documentation. I've begun crafting the content iteratively, constantly refining it. I'm focusing on the requirement spec's structure and simulating a professional approach based on the "Tree Hole" concept. I'm keeping the design simple and production-ready, emphasizing "Warm/Healing" colors. For the final polish, I'm using professional Chinese for the spec, English for code instructions, and ensuring the "God Prompt" is copy-paste ready.<br><br><br>
  </details>
</div>

è¿™æ˜¯ä¸€ä¸ªä¸ºæ‚¨å®šåˆ¶çš„**å‰ç«¯å¼€å‘æ¶æ„è®¾è®¡ä¸AIæŒ‡ä»¤æ–‡æ¡£**ã€‚

åŸºäºæ‚¨æä¾›çš„èƒŒæ™¯ï¼ˆåŒ»ç–—å…¬ç›Šã€Vibe Codingã€å¾®åº”ç”¨çŸ©é˜µï¼‰ä»¥åŠâ€œå°é¦¨å®Â·æ ‘æ´â€çš„å…·ä½“å®šä½ï¼ˆå¿ƒç†ç–å¯¼ã€CBTç–—æ³•ï¼‰ï¼Œæˆ‘é€‰æ‹©äº†**Next.js + Tailwind CSS** ä½œä¸ºæŠ€æœ¯æ ˆã€‚è¿™å¥—ç»„åˆæ˜¯ç›®å‰ AI è¾…åŠ©ç¼–ç¨‹ï¼ˆCursor/Windsurf/v0ï¼‰ç”Ÿæˆè´¨é‡æœ€é«˜ã€å¼€å‘é€Ÿåº¦æœ€å¿«çš„â€œé»„é‡‘æ ‡å‡†â€ã€‚

æ‚¨å¯ä»¥ç›´æ¥å°†ä»¥ä¸‹å†…å®¹å¤åˆ¶ç»™ Cursor æˆ– Claude Code ä½¿ç”¨ã€‚

---

# [Project: å°é¦¨å®Â·æ ‘æ´ (Xiaoxinbao Tree Hole)] Technical Specification

## 1. æ¶æ„å†³ç­–è®°å½• (ADR)
- **Framework**: **Next.js 14 (App Router)**
 - *ç†ç”±*: é›¶é…ç½®è·¯ç”±ï¼Œå®Œç¾çš„ React ç”Ÿæ€æ”¯æŒï¼Œææ˜“éƒ¨ç½²åˆ° Vercel/Netlifyï¼Œä¸” AI å¯¹å…¶ä»£ç ç”Ÿæˆå‡†ç¡®ç‡æé«˜ã€‚
- **Styling**: **Tailwind CSS + Shadcn/UI**
 - *ç†ç”±*: èƒ½å¤Ÿå¿«é€Ÿæ„å»ºâ€œæ²»æ„ˆç³»â€UIï¼ˆåœ†è§’ã€æŸ”å’Œé˜´å½±ï¼‰ï¼ŒShadcn æä¾›äº†é«˜è´¨é‡çš„æ— éšœç¢ç»„ä»¶ï¼ˆAccessibilityï¼‰ã€‚
- **State Management**: **Zustand** (Optional) or React Context
 - *ç†ç”±*: è½»é‡çº§ï¼Œé€‚åˆç®¡ç†èŠå¤©è®°å½•å’Œç”¨æˆ·ä¼šè¯çŠ¶æ€ã€‚
- **HTTP Client**: **Axios**
 - *ç†ç”±*: ç›¸æ¯” fetch æä¾›æ›´å¥½çš„æ‹¦æˆªå™¨æ”¯æŒï¼ˆå¤„ç† Tokenã€ç»Ÿä¸€é”™è¯¯å“åº”ï¼‰ã€‚

## 2. ç³»ç»Ÿè®¾è®¡ (System Design)

### 2.1 ç›®å½•ç»“æ„ (File Tree)
```bash
/src
  /app
    /chat        # æ ¸å¿ƒèŠå¤©é¡µé¢
    /layout.tsx  # å…¨å±€å¸ƒå±€ (åŒ…å« SEO Meta, å­—ä½“)
    /page.tsx    # æ¬¢è¿é¡µ/Landing Page
  /components
    /ui          # Shadcn åŸºç¡€ç»„ä»¶ (Button, Input, Card)
    /chat        # ä¸šåŠ¡ç»„ä»¶ (Bubble, InputArea, Header)
  /lib
    api.ts       # Axios å®ä¾‹é…ç½® (Base URL)
    utils.ts     # å·¥å…·å‡½æ•°
  /types         # TS ç±»å‹å®šä¹‰
```

### 2.2 æ ¸å¿ƒæ•°æ®æ¨¡å‹ (Types)
```typescript
// æ¶ˆæ¯å®ä½“
interface Message {
  id: string;
  role: 'user' | 'assistant' | 'system';
  content: string;
  timestamp: number;
  status?: 'sending' | 'sent' | 'error';
}

// API å“åº”ç»“æ„ (å‡è®¾)
interface ApiResponse<T> {
  code: number;
  data: T;
  message: string;
}
```

### 2.3 å…³é”®äº¤äº’æµç¨‹ (UX Flow)
1. **Onboarding**: ç”¨æˆ·è¿›å…¥ -> æ˜¾ç¤ºæ¸©é¦¨æ¬¢è¿è¯­ + å…è´£å£°æ˜ï¼ˆéåŒ»ç–—è¯Šæ–­ï¼‰ -> ç”¨æˆ·ç‚¹å‡»â€œå¼€å§‹å€¾è¯‰â€ã€‚
2. **Chat Loop**:
 - ç”¨æˆ·è¾“å…¥æ–‡å­— -> ç•Œé¢ç«‹å³é€šè¿‡ Optimistic UI æ˜¾ç¤ºæ¶ˆæ¯ã€‚
 - è°ƒç”¨ API -> æ˜¾ç¤ºâ€œå¯¹æ–¹æ­£åœ¨è¾“å…¥...â€åŠ¨ç”» (Typing Indicator)ã€‚
 - æ¥æ”¶å“åº” -> æ¸²æŸ“å›å¤ï¼ˆæ”¯æŒ Markdown æ¸²æŸ“ï¼Œä»¥ä¾¿ç»“æ„åŒ–å±•ç¤ºå»ºè®®ï¼‰ã€‚
3. **Safety**: åº•éƒ¨å¸¸é©»â€œä¸€é”®æ±‚åŠ©â€æˆ–â€œå±æœºå¹²é¢„çƒ­çº¿â€å…¥å£ï¼ˆé’ˆå¯¹æç«¯æƒ…ç»ªï¼‰ã€‚

## 3. è¯¦ç»†å®ç°è¦æ±‚ (Implementation Constraints)

- **Visual Style (æ²»æ„ˆç³»è®¾è®¡)**:
 - **Color Palette**: å¿…é¡»ä½¿ç”¨ä½é¥±å’Œåº¦é…è‰²ã€‚
 - Primary: æ¸©æš–çš„é¼ å°¾è‰ç»¿ (Sage Green) æˆ– æŸ”å’Œçš„é™¶åœŸè‰² (Terra Cotta).
 - Background: ç±³ç™½è‰² (Cream/Off-white)ï¼Œé¿å…çº¯é»‘çº¯ç™½å¸¦æ¥çš„è§†è§‰åˆºæ¿€ã€‚
 - **Typography**: å¤§å­—å·ï¼Œè¡Œè·å®½æ¾ï¼Œæ˜“äºé˜…è¯»ã€‚
- **Responsiveness**: **Mobile-First**ã€‚90% çš„åœºæ™¯æ˜¯åœ¨æ‰‹æœºä¸Šä½¿ç”¨ã€‚
- **Error Handling**: ç½‘ç»œé”™è¯¯æ—¶ï¼Œä¸èƒ½å¼¹å‡ºå†°å†·çš„ç³»ç»ŸæŠ¥é”™ï¼Œåº”æ˜¾ç¤ºâ€œå°é¦¨å®å¥½åƒèµ°ç¥äº†ï¼Œè¯·å†è¯•ä¸€æ¬¡â€ã€‚
- **API Integration**: æ‰€æœ‰çš„ API è¯·æ±‚ URL éœ€é…ç½®åœ¨ `.env.local` ä¸­ï¼Œé€šè¿‡ `process.env.NEXT_PUBLIC_API_URL` è°ƒç”¨ã€‚

---

## 4. ç»™ AI ç¼–ç¨‹å·¥å…·çš„ç»ˆææŒ‡ä»¤ (The "God Prompt")

**è¯·å°†ä»¥ä¸‹å†…å®¹ç›´æ¥å¤åˆ¶åˆ° Cursor Composer / Windsurf / Claude Code ä¸­ï¼š**

```markdown
Act as a Senior Frontend Engineer specializing in Healthcare/Mental Wellness UX. 
You are tasked to build the frontend for "Xiaoxinbao Tree Hole" (å°é¦¨å®Â·æ ‘æ´), an AI-powered psychological support chat application.

**Context & Tech Stack:**
1.  **Framework**: Next.js 14 (App Router), TypeScript.
2.  **Styling**: Tailwind CSS, Lucide React (Icons).
3.  **Components**: Use Shadcn/UI (simulate the code for components like Card, Button, Input, ScrollArea).
4.  **Network**: Axios.

**Design Philosophy (Crucial):**
- **Vibe**: Calming, Safe, Warm, Non-judgmental.
- **Colors**: Use a "Cream & Sage" palette. Background should be `#FDFCF8` (Warm White), Accents `#8DA399` (Sage).
- **Mobile First**: The UI must feel like a native mobile app.

**Implementation Steps:**

**Step 1: Setup & Configuration**
- Create the project structure.
- Define the `Message` interface in `/types`.
- Setup a mock `.env` variable for `NEXT_PUBLIC_API_URL`.
- Create an `api.ts` utility using Axios with a placeholder Base URL.

**Step 2: UI Components (The "Healing" Look)**
- Create a `ChatLayout` that maximizes screen height for mobile.
- Implement `MessageBubble`:
    - User messages: Align right, soft green background, rounded corners.
    - AI messages: Align left, white background with soft shadow, support Markdown rendering (use `react-markdown` if possible, or simple text for now).
- Implement `InputArea`: A clean text input with a "Send" button that disables when empty or loading.

**Step 3: Core Logic (The Chat Flow)**
- Use `useState` to manage the list of messages.
- Implement the `sendMessage` function:
    1. Add user message to state immediately.
    2. Set `isLoading` to true.
    3. POST to `/api/chat` (assume this endpoint exists).
    4. On success: Append AI response.
    5. On error: Show a gentle toast notification ("Connection unstable, please try again").

**Step 4: Safety & Disclaimer**
- Add a visible but non-intrusive "Medical Disclaimer" at the bottom of the chat or as the first system message: "AI response is for emotional support only, not medical diagnosis."

**Immediate Action:**
Start by scaffolding the `page.tsx` (Chat Interface) and the required Tailwind configuration for the custom colors. Do not wait for approval, generate the code now.
```
